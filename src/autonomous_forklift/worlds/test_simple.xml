<?xml version="1.0" encoding="UTF-8"?>
<!-- Mundo de prueba simple: Robot + Pallet -->
<mvsim_world version="1.0">
	<simul_timestep>0</simul_timestep>

	<gui>
		<ortho>false</ortho>
		<show_forces>false</show_forces>
		<cam_distance>10</cam_distance>
		<fov_deg>60</fov_deg>
		<refresh_fps>25</refresh_fps>
	</gui>

	<!-- Ground -->
	<element class="ground_grid">
		<floating>true</floating>
		<color>#222222</color>
		<x_min>-20</x_min> <x_max>20</x_max>
		<y_min>-20</y_min> <y_max>20</y_max>
	</element>

	<!-- =============================
		   Vehicle class definition
	     ============================= -->
	<vehicle:class name="forklift_class">
		<dynamics class="differential">
			<l_wheel pos="0.0  0.416" mass="5.0" width="0.125" diameter="0.325" />
			<r_wheel pos="0.0 -0.416" mass="5.0" width="0.125" diameter="0.325" />
			<chassis mass="50.0" zmin="0.15" zmax="2.0">
				<shape>
					<pt>-1.0 -0.4</pt>
					<pt>-1.0  0.4</pt>
					<pt> 0.2  0.4</pt>
					<pt> 0.2 -0.4</pt>
				</shape>
			</chassis>
			<caster_wheel pos="1.0 0.0" mass="10.0" radius="0.15" />
			<controller class="twist_ideal">
				<max_torque>200</max_torque>
			</controller>
		</dynamics>

		<friction class="default">
			<mu>0.8</mu>
			<C_damping>5</C_damping>
		</friction>

		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/pallet_jack.zip/pallet_jack/pallet_jack.dae</model_uri>
			<model_roll>90.0</model_roll>
			<model_scale>1.25</model_scale>
		</visual>

		<!-- LIDAR -->
		<sensor class="laser" name="scan">
			<pose_3d>0.3 0 0.5 0 0 0</pose_3d>
			<fov_degrees>360</fov_degrees>
			<sensor_period>0.05</sensor_period>
			<nrays>360</nrays>
			<max_range>25.0</max_range>
			<min_range>0.05</min_range>
			<raytrace_3d>false</raytrace_3d>
			<publish_topic>/scan</publish_topic>
		</sensor>

		<!-- CÃ¡mara baja -->
		<sensor class="camera" name="camera_low">
			<pose>1.3 0 0.5 0 180 0</pose>
			<resolution>640 480</resolution>
			<fov_degrees>90</fov_degrees>
			<sensor_period>0.1</sensor_period>
			<publish_topic>/camera_low/image_raw</publish_topic>
		</sensor>
	</vehicle:class>

	<!-- ========================
		   Vehicle instance
	     ======================== -->
	<vehicle name="forklift" class="forklift_class">
		<init_pose>0 0 0</init_pose>
	</vehicle>

	<!-- ========================
		   Pallet (delante del robot)
	     ======================== -->
	<block:class name="pallet_class">
		<mass>10</mass>
		<ground_friction>0.5</ground_friction>
		<shape_from_visual/>
		<visual>
			<model_uri>https://mrpt.github.io/mvsim-models/pallet.zip/pallet/pallet.dae</model_uri>
			<model_roll>90.0</model_roll>
			<model_offset_z>0.08</model_offset_z>
			<model_scale>1.5</model_scale>
		</visual>
	</block:class>

	<block class="pallet_class" name="test_pallet">
		<init_pose3d>3 0 0 0 0 0</init_pose3d>
	</block>

</mvsim_world>
